## Yılın Editi - Supabase ile paylaşılabilir oy sistemi

Bu proje Twitter (X) embed’lerini ekleyip oylayabileceğin bir liste sunar. Artık veriler Supabase üzerinde tutulduğu için herkes aynı kayıtları ve oyları görür.

### Kurulum
1) Bağımlılıklar: `npm install`
2) Ortam değişkenleri (.env.local):
   - `VITE_SUPABASE_URL=https://mmuahzsgkrbjslezsbig.supabase.co`
   - `VITE_SUPABASE_ANON_KEY=<anon anahtarınız>` (service key’i istemciye koymayın)
   - `GEMINI_API_KEY=<opsiyonel>`
3) Çalıştırma: `npm run dev`

### Supabase şeması
```sql
create table if not exists submissions (
  id text primary key,
  tweet_url text not null,
  tweet_id text not null unique,
  caption text not null,
  category text not null,
  votes int default 0,
  timestamp bigint not null,
  author text,
  created_at timestamptz default now()
);

create table if not exists votes (
  id bigint generated by default as identity primary key,
  submission_id text references submissions(id) on delete cascade,
  user_token text not null,
  vote text check (vote in ('up','down')),
  created_at timestamptz default now(),
  unique (submission_id, user_token)
);
```

### Row Level Security (önerilen)
- RLS’i açın ve `submissions` için anon role’e select/insert, `votes` için select/insert/update/delete (unique constraint için delete gerekli) izinleri verin.
- `votes` tablosunda `unique (submission_id, user_token)` kısıtı kullanıcı başına tek oy sağlar; istemci localStorage’daki `twitter_user_token` ile kullanıcıyı tanımlar.

### Çalışma mantığı
- İstemci Supabase’ten `submissions` ve `votes` verisini çekip oy toplamını hesaplar.
- Yeni kayıt eklerken tweetId üzerinde sunucu tarafı duplicate kontrolü yapılır.
- Oy verirken `votes` tablosu güncellenir; ekrana yansıması için Supabase’ten tekrar çekilir.
